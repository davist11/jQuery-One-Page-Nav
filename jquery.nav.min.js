/*
 * jQuery One Page Nav Plugin
 * http://github.com/davist11/jQuery-One-Page-Nav
 *
 * Copyright (c) 2010 Trevor Davis (http://trevordavis.net)
 * Dual licensed under the MIT and GPL licenses.
 * Uses the same license as jQuery, see:
 * http://jquery.org/license
 *
 * @version 0.9.1
 */
(function(d){d.fn.onePageNav=function(j){var i=d.extend({},d.fn.onePageNav.defaults,j),f={sections:{},bindNav:function(c,b,a){var e=c.parent(),h=c.attr("href"),g=d(window);e.hasClass(a.currentClass)||(a.begin&&a.begin(),f.adjustNav(b,e,a.currentClass),g.unbind(".onePageNav"),d.scrollTo(h,a.scrollSpeed,{easing:a.easing,offset:{top:-a.scrollOffset},onAfter:function(){a.changeHash&&(window.location.hash=h);g.bind("scroll.onePageNav",function(){f.scrollChange(b,a)});a.end&&a.end()}}))},adjustNav:function(c,
b,a){c.find("."+a).removeClass(a);b.addClass(a)},getLastSection:function(c,b){var a,e=c.find("a");""!==b.filter&&(e=e.filter(b.filter));e.each(function(){var b=d(this).attr("href");0<=Math.max(0,d(b).offset().top)&&(a=b.substr(1))});return a},getPositions:function(c,b){var a=c.find("a");""!==b.filter&&(a=a.filter(b.filter));a.each(function(){var a=d(this).attr("href"),c=d(a).offset().top;f.sections[a.substr(1)]=Math.round(c)-b.scrollOffset})},getSection:function(c,b,a){var e="",h=Math.round(d(window).height()*
a.scrollThreshold);lastSection=f.getLastSection(c,a);if(d(window).scrollTop()+d(window).height()>=d(document).height()-d(lastSection).height()-5)e=lastSection;else for(var g in f.sections)f.sections[g]-h<b&&(e=g);return e},scrollChange:function(c,b){f.getPositions(c,b);var a=d(window).scrollTop(),a=f.getSection(c,a,b);""!==a&&f.adjustNav(c,c.find("a[href=#"+a+"]").parent(),b.currentClass)},init:function(c,b){var a=!1,e=c.find("a");""!==b.filter&&(e=e.filter(b.filter));e.bind("click",function(a){f.bindNav(d(this),
c,b);a.preventDefault()});f.getPositions(c,b);d(window).bind("scroll.onePageNav",function(){a=!0});setInterval(function(){a&&(a=!1,f.scrollChange(c,b))},250)}};return this.each(function(){var c=d(this),b=d.meta?d.extend({},i,c.data()):i;f.init(c,b)})};d.fn.onePageNav.defaults={currentClass:"current",changeHash:!1,easing:"swing",filter:"",scrollSpeed:750,scrollOffset:0,scrollThreshold:0.5,begin:!1,end:!1}})(jQuery);
